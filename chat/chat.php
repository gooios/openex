<?phperror_reporting(0);//  A chatroom that uses the jquery version below://  http://hostpile.info/jquery-1.9.1.jsinclude("../models/config.php")// original script by zelles// modified by r3wt for OpenEx$sql = mysql_query("CREATE TABLE IF NOT EXISTS chat_messages (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), date VARCHAR(300), ip VARCHAR(30), username TEXT, message TEXT, status VARCHAR(300))");$username = 'user'.rand(11,99);$date = strtotime('now');$ip = $_SERVER['REMOTE_ADDR'];$ajax = addslashes(strip_tags($_POST['ajax']));if($ajax==='speaker') {   $speaker_username = addslashes(strip_tags($_POST['username']));   $speaker_comment = addslashes(strip_tags($_POST['speaker']));   $sql = mysql_query("INSERT INTO chat (id,date,ip,username,message,status) VALUES ('','$date','$ip','$speaker_username','$speaker_comment','viewable')");   mysql_close($db_handle);   die('');   exit;}$ajax = addslashes(strip_tags($_GET['ajax']));if($ajax==='room') {   $chatter_username = addslashes(strip_tags($_GET['username']));   $Query = mysql_query("SELECT date, username, message FROM chat WHERE status='viewable' ORDER BY id DESC LIMIT 30");   while($Row = mysql_fetch_assoc($Query)) {      $db_chat_date = $Row['date'];      $db_chat_username = $Row['username'];      $db_chat_message = $Row['message'];      if($chatter_username==$db_chat_username) { $char_color = '0489B1'; } else { $char_color = '0B3861'; }      $db_chat_message = ereg_replace("[[:alpha:]]+://[^<>[:space:]]+[[:alnum:]/]","<a href=\\"\\\\0\\" target='_blank'>\\\\0</a>", $db_chat_message);      $newcomment = '<p title="'.date("n/j/Y g:i:s a",$db_chat_date).'" style="font-size: 12px; padding-bottom: 3px;"><b style="color: #'.$char_color.';">'.$db_chat_username.': </b>'.$db_chat_message.'</p>';      $compilecomments = $newcomment.$compilecomments;   }   mysql_close($db_handle);   die($compilecomments);   exit;}mysql_close($db_handle);?><html><head>   <title>Chatroom</title>   <script type="text/javascript" src="http://hostpile.info/jquery-1.9.1.js"></script>   <script type="text/javascript">      function zellesChat() {         $.ajax({            type: "POST", url: "chatroom.php",            data: $("#zellesspeaker").serialize(),            success: function(response){               $("#speaker").val("");               $("#zelleschatroom").load("chatroom.php?ajax=room&username=<?php echo $username; ?>");               $("#zelleschatroom").scrollTop($("#zelleschatroom")[0].scrollHeight);            }         });         return false;      }      setTimeout(function () {         $("#zelleschatroom").load("chatroom.php?ajax=room&username=<?php echo $username; ?>");      }, 200);      setTimeout(function() {         $("#zelleschatroom").scrollTop($("#zelleschatroom")[0].scrollHeight);      }, 1000);      setInterval(function () {         $("#zelleschatroom").load("chatroom.php?ajax=room&username=<?php echo $username; ?>");         $("#zelleschatroom").scrollTop($("#zelleschatroom")[0].scrollHeight);      }, 2000);   </script></head><body>   <form id="zellesspeaker" onsubmit="return zellesChat();">      <input type="hidden" name="ajax" value="speaker">      <input type="hidden" name="username" value="<?php echo $username; ?>">      <table style="width: 100%;">         <tr>            <td>               <div id="zelleschatroom" style="width: 100%; height: 300px; border: 1px solid #BBBBBB; padding: 3px; overflow-y: scroll;">               </div>            </td>         </tr><tr>            <td><input type="text" name="speaker" id="speaker" style="width: 100%;" autofocus></td>         </tr><tr>            <td align="right"><input type="submit" name="submit" value="Post"></td>         </tr>      </table>   </form></body></html>